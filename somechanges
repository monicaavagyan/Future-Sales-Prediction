I do some changes in this code.
